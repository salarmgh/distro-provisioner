---
- name: Create directories
  file:
    path: "{{ item }}"
    state: directory
    owner: salarmgh
    group: salarmgh
    mode: '0755'
  with_items: "{{ dirs }}"

- name: Copy configs
  copy:
    src: "{{ item.src }}"
    dest: "{{ item.dest }}"
    owner: salarmgh
    group: salarmgh
    mode: "{{ item.perm }}"
  with_items: "{{ copy_files }}"

- name: Configure bashrc
  lineinfile:
    path: /home/salarmgh/.bashrc
    state: present
    line: |
      {{ bash_custom_config }}

- name: Download vim plug
  get_url:
    url: https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
    dest: /home/salarmgh/.vim/autoload/plug.vim
    mode: '0644'

- name: Install vim plugins
  command: vim +'PlugInstall --sync' +qall &> /dev/null < /dev/tty

- name: Add user to groups
  user:
    name: salarmgh
    groups: "{{ item }}"
    append: yes
  become: true
  with_items: "{{ user_groups }}"
  
- name: Fix QT Scale Factor
  lineinfile:
    path: /etc/environment
    line: QT_SCALE_FACTOR=2
  become: true
  when: is_hidpi
